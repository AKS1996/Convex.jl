<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimizing in a Loop · Convex.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Convex.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../installation/">Installation</a></li><li><a class="toctext" href="../quick_tutorial/">Quick Tutorial</a></li><li><a class="toctext" href="../types/">Basic Types</a></li><li><a class="toctext" href="../operations/">Supported Operations</a></li><li><a class="toctext" href="../examples/">Examples</a></li><li><a class="toctext" href="../complex-domain_optimization/">Complex-domain Optimization</a></li><li><a class="toctext" href="../solvers/">Solvers</a></li><li><a class="toctext" href="../faq/">FAQ</a></li><li class="current"><a class="toctext" href>Optimizing in a Loop</a><ul class="internal"><li><a class="toctext" href="#Memory-Management-1">Memory Management</a></li><li><a class="toctext" href="#Caching-Expressions-1">Caching Expressions</a></li><li><a class="toctext" href="#Warmstarts,-Parameters,-Fixing-and-Freeing-Variables-1">Warmstarts, Parameters, Fixing and Freeing Variables</a></li></ul></li><li><a class="toctext" href="../advanced/">Advanced</a></li><li><a class="toctext" href="../problem_depot/">Problem Depot</a></li><li><a class="toctext" href="../contributing/">Contributing</a></li><li><a class="toctext" href="../credits/">Credits</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Optimizing in a Loop</a></li></ul><a class="edit-page" href="https://github.com/JuliaOpt/Convex.jl/blob/master/docs/src/loop.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Optimizing in a Loop</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Optimizing-in-a-Loop-1" href="#Optimizing-in-a-Loop-1">Optimizing in a Loop</a></h1><h2><a class="nav-anchor" id="Memory-Management-1" href="#Memory-Management-1">Memory Management</a></h2><p>Convex uses a module-level dictionary to store the conic forms of every variable and expression created in the same Julia session. These variables and expressions persist even after they are out of scope. If you create large numbers of variables inside a loop, this dictionary can eat a considerable amount of memory.</p><p>To flush the memory, you can call <code>Convex.clearmemory()</code>.</p><p>This will remove every variable and expression you&#39;ve formed before from the memory cache, so that you&#39;re starting as fresh as if you&#39;d just reimported Convex.</p><h2><a class="nav-anchor" id="Caching-Expressions-1" href="#Caching-Expressions-1">Caching Expressions</a></h2><p>Better yet, take advantage of this cache of variables and expressions! Create variables and expressions outside the loop, and reuse them inside the loop as you tweak parameters. Doing this will allow Convex to reuse the conic forms it has already calculated for previously used expressions.</p><p>For example, the following <strong>bad</strong> code will create a new instance of a variable and of the expression <code>square(x)</code> for each value of <code>i</code>. Don&#39;t do this:</p><pre><code class="language-julia">for i = 1:10
    x = Variable()
    p = minimize(square(x), x &gt;= i)
    solve!(p, SCSSolver())
end</code></pre><p>Contrast this with the following <strong>good</strong> code, which will reuse the cached conic form for <code>square(x)</code> for each <code>i</code>, reducing the memory footprint and speeding up the computation. Do this instead:</p><pre><code class="language-julia">x = Variable()
obj = square(x)
for i = 1:10
    p = minimize(obj, x &gt;= i)
    solve!(p, SCSSolver())
end</code></pre><h2><a class="nav-anchor" id="Warmstarts,-Parameters,-Fixing-and-Freeing-Variables-1" href="#Warmstarts,-Parameters,-Fixing-and-Freeing-Variables-1">Warmstarts, Parameters, Fixing and Freeing Variables</a></h2><p>If you&#39;re solving many problems of the same form, or many similar problems, you may also want to use warmstarts, or to dynamically fix and free variables. The former is particularly good for a family of problems related by a parameter; the latter allows for easy implementation of alternating minimization for nonconvex problems. See the <a href="../advanced/#Advanced-Features-1">Advanced Features</a> section of the documentation for more information.</p><footer><hr/><a class="previous" href="../faq/"><span class="direction">Previous</span><span class="title">FAQ</span></a><a class="next" href="../advanced/"><span class="direction">Next</span><span class="title">Advanced</span></a></footer></article></body></html>
